{"ast":null,"code":"import { saveCells } from '../action-creators';\nimport { ActionType } from '../action-types';\nexport const persistMiddleware = ({\n  dispatch,\n  getState\n}) => {\n  let timer;\n  return next => {\n    return action => {\n      next(action);\n\n      if ([ActionType.MOVE_CELL, ActionType.UPDATE_CELL, ActionType.DELETE_CELL, ActionType.INSERT_CELL_AFTER].includes(action.type)) {\n        if (timer) {\n          clearTimeout(timer);\n        }\n\n        timer = setTimeout(() => {\n          saveCells()(dispatch, getState);\n        }, 250);\n      }\n    };\n  };\n};","map":{"version":3,"sources":["/home/utoker/Projects/utcode/packages/local-client/src/state/middlewares/persist-middleware.ts"],"names":["saveCells","ActionType","persistMiddleware","dispatch","getState","timer","next","action","MOVE_CELL","UPDATE_CELL","DELETE_CELL","INSERT_CELL_AFTER","includes","type","clearTimeout","setTimeout"],"mappings":"AACA,SAASA,SAAT,QAA0B,oBAA1B;AACA,SAASC,UAAT,QAA2B,iBAA3B;AAIA,OAAO,MAAMC,iBAAiB,GAAG,CAAC;AAChCC,EAAAA,QADgC;AAEhCC,EAAAA;AAFgC,CAAD,KAM3B;AACJ,MAAIC,KAAJ;AACA,SAAQC,IAAD,IAAoC;AACzC,WAAQC,MAAD,IAAoB;AACzBD,MAAAA,IAAI,CAACC,MAAD,CAAJ;;AAEA,UACE,CACEN,UAAU,CAACO,SADb,EAEEP,UAAU,CAACQ,WAFb,EAGER,UAAU,CAACS,WAHb,EAIET,UAAU,CAACU,iBAJb,EAKEC,QALF,CAKWL,MAAM,CAACM,IALlB,CADF,EAOE;AACA,YAAIR,KAAJ,EAAW;AACTS,UAAAA,YAAY,CAACT,KAAD,CAAZ;AACD;;AACDA,QAAAA,KAAK,GAAGU,UAAU,CAAC,MAAM;AACvBf,UAAAA,SAAS,GAAGG,QAAH,EAAaC,QAAb,CAAT;AACD,SAFiB,EAEf,GAFe,CAAlB;AAGD;AACF,KAlBD;AAmBD,GApBD;AAqBD,CA7BM","sourcesContent":["import { Dispatch } from 'redux';\nimport { saveCells } from '../action-creators';\nimport { ActionType } from '../action-types';\nimport { Action } from '../actions';\nimport { RootState } from '../reducers';\n\nexport const persistMiddleware = ({\n  dispatch,\n  getState,\n}: {\n  dispatch: Dispatch<Action>;\n  getState: () => RootState;\n}) => {\n  let timer: NodeJS.Timeout;\n  return (next: (action: Action) => void) => {\n    return (action: Action) => {\n      next(action);\n\n      if (\n        [\n          ActionType.MOVE_CELL,\n          ActionType.UPDATE_CELL,\n          ActionType.DELETE_CELL,\n          ActionType.INSERT_CELL_AFTER,\n        ].includes(action.type)\n      ) {\n        if (timer) {\n          clearTimeout(timer);\n        }\n        timer = setTimeout(() => {\n          saveCells()(dispatch, getState);\n        }, 250);\n      }\n    };\n  };\n};\n"]},"metadata":{},"sourceType":"module"}